project: example

metadata:
  version: 0.1.3
  description: Now reqs should be specified.
  author: Oleg Smirnov
  authorEmail: oleg.smirnov@jetbrains.com
  url: jetbrains.com

subprojects:
  - subproject
  - dependency

roots:
  sources: src/main
  tests: src/test
  dist: src/dist

# Prerequisites: https://github.com/pyenv/pyenv/wiki#suggested-build-environment
environment:
  path: .venv
  python: 3.9

# By default, any custom repository will have precedence over PyPI (secondary == False)
repositories:
  - name: grazie-ml
    url: https://packages.jetbrains.team/pypi/p/grazi/grazie-ml/simple
    default: False # If True, this would disable the global PyPI repo, and make <ml> the default fallback source

  - name: test-pypi
    url: https://packages.jetbrains.team/pypi/p/paddle/test-pypi/simple
    uploadUrl: https://packages.jetbrains.team/pypi/p/paddle/test-pypi/legacy/

#  - name: paper-analyzer
#    url: https://repo.labs.intellij.net/artifactory/api/pypi/paper-analyzer/simple/
#    secondary: True # Thus, <grazie-ml> still would be the primary source. But without such flag, this repo would have precedence over <ml>

requirements:
  - name: redis
    version: <=3.5.3

  - name: grazie-supar
    version: ~=1.2.1

plugins:
  enabled:
    - python
    - docker
    - ssh
#    - example-test
#  jars:
#    - ".../paddle/example/plugins/test-plugin-0.1.0.jar"

tasks:
  run:
    - id: main
      entrypoint: src/main/main.py
    - id: main_as_module
      entrypoint: src.main.main
  test:
    pytest:
      - id: tests_main_suite
        targets:
          - src/test/test_sample.py
  publish:
    repo: test-pypi
    twine:
      skipExisting: True
      verbose: True

#executor:
#  type: docker
#  image: python:3.9-slim
#
#executor:
#  type: ssh
#  user: admin
#  host: localhost
#  directory: /home/project/
